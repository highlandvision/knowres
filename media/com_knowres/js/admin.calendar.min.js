"use strict";"undefined"==typeof jQuery&&jQuery.noConflict(),function($){let ui_aDate,ui_dDate,ui_eDate,ui_minDays,ui_booked;function beforeShowDay(date){date=new Date(date);return function(thisDate,aDate,dDate){if(aDate&&dDate&&aDate<=thisDate&&thisDate<=dDate)return[!0,"datepick-selected"];let value;{if(void 0===ui_booked[thisDate])return[!0,""];value=ui_booked[thisDate]}return 0===value||3===value?[!1,"datepick-booked"]:1===value?[!1,"datepick-booked datepick-half"]:[!0,"datepick-booked datepick-half135"]}($.datepicker.formatDate("yy-mm-dd",date),ui_aDate,ui_dDate)}function beforeShowDayDepart(date){date=new Date(date);return function(thisDate,aDate,dDate){if(aDate&&dDate&&aDate<=thisDate&&thisDate<=dDate)return[!0,"datepick-selected"];if(thisDate>=ui_eDate)return[!1,"datepick-disabled"];let value;{if(void 0===ui_booked[thisDate])return[!0,""];value=ui_booked[thisDate]}return 0===value||3===value?[!1,"datepick-booked"]:1===value?[!0,"datepick-booked datepick-half"]:[!1,"datepick-booked datepick-half135"]}($.datepicker.formatDate("yy-mm-dd",date),ui_aDate,ui_dDate)}function getDpDate(element,format){let date;try{date=$.datepicker.parseDate(format,element.value)}catch(error){date=null}return date}$(function(){$(document).on("click","#kr-property-calendar .bookme",function(){!function(property_id,arrival){let formData=new FormData;formData.append("property_id",property_id),formData.append("arrival",arrival),formData.append("source","calendar"),$.ajax({url:"index.php?option=com_knowres&task=contract.modalbook",dataType:"json",method:"POST",cache:!1,contentType:!1,processData:!1,data:formData,success:function(result){if(result.success){ui_aDate=result.data.ui_aDate,ui_dDate=result.data.ui_dDate,ui_eDate=result.data.ui_eDate,ui_minDays=result.data.ui_minDays;try{ui_booked=JSON.parse(result.data.ui_booked)}catch(e){ui_booked=[]}$("#kr-contract-modal-book .modal-content").empty().append(result.data.html).draggable({handle:".modal-header"}),$("#kr-contract-modal-book").modal("show");const $from=$("#jform_arrivaldsp").datepicker({altField:"#arrival",altFormat:"yy-mm-dd",buttonText:'<i class="fa-solid fa-calendar-alt"></i>',changeMonth:!0,changeYear:!0,dateFormat:"d M yy",defaultDate:arrival,minDate:ui_minDays,numberOfMonths:1,selectOtherMonths:!0,showOn:"both",showOtherMonths:!0,beforeShowDay:beforeShowDay}).on("change",function(){ui_aDate=$.datepicker.formatDate("yy-mm-dd",new Date($(this).val())),$to.datepicker("option","minDate",getDpDate(this,"mm/dd/yy"));let new2=$("#jform_arrivaldsp").datepicker("getDate","+1d");new2.setDate(new2.getDate()+1),$("#jform_departuredsp").datepicker("setDate",new2),ui_dDate=$.datepicker.formatDate("yy-mm-dd",new Date(new2)),$("#kr-contract-modal-book #arrival").val(ui_aDate)}),$to=$("#jform_departuredsp").datepicker({altField:"#departure",altFormat:"yy-mm-dd",buttonText:'<i class="fa-solid fa-calendar-alt"></i>',changeMonth:!0,changeYear:!0,defaultDate:"+1d",dateFormat:"d M yy",numberOfMonths:1,showOn:"both",selectOtherMonths:!0,showOtherMonths:!0,beforeShowDay:beforeShowDayDepart}).on("change",function(){ui_dDate=$.datepicker.formatDate("yy-mm-dd",new Date($(this).val())),$from.datepicker("option","maxDate",getDpDate(this,"mm/dd/yy")),$("#kr-contract-modal-book #departure").val(ui_dDate)})}},error:function(){alert("Sorry we cannot process your request at the moment. Please try again later!")}})}($("#kr-property-calendar").data("property_id"),$(this).data("date"))}).on("click","#kr-property-calendar .modalshow",function(){let block="c";!function(property_id,id,block){let formData=new FormData;formData.append("id",id),formData.append("block",block),formData.append("gobackto","task=property.calendar&id="+property_id),$.ajax({url:"index.php?option=com_knowres&task=contract.modalshow",type:"POST",data:formData,dataType:"json",cache:!1,contentType:!1,processData:!1,success:function(result){result.success?($("#kr-calendar-modal-show .modal-content").empty().append(result.data.html).draggable({handle:".modal-header"}),$("#kr-calendar-modal-show").modal("show"),$("#kr-gantt-tab").tab()):result.message?alert(result.message):alert("Sorry we cannot process your request at the moment. Please try again later!")},error:function(result){alert("Sorry we cannot process your request at the moment. Please try again later!")}})}($("#kr-property-calendar").data("property_id"),$(this).data("id"),block=$(this).data("ical")?"":block)}).on("click","#newreservation",function(e){e.preventDefault();e=$(this).attr("href")+"&arrival="+$("#arrival").val()+"&departure="+$("#departure").val();window.location.replace(e)}).on("click",".modalshowcancel",function(e){e.preventDefault();e=$(this).data("id");$.ajax({type:"POST",dataType:"json",url:"index.php?option=com_knowres&task="+$(this).data("task"),data:{id:e},success:function(result){result.success?window.location.reload():alert(result.message)}})})})}(jQuery),function($){const ui_options={buttonText:'<i class="fa-solid fa-calendar-alt"></i>',changeMonth:!0,changeYear:!0,dateFormat:"d M yy",firstDay:1,numberOfMonths:1,selectOtherMonths:!0,showButtonPanel:!0,showOn:"both",showOtherMonths:!0};$(function(){const $cal=$(".uicalendar");$cal.length&&($("[data-datepicker]").each(function(){$.extend(ui_options,$(this).data("datepicker")),$(this).datepicker(ui_options)}),$cal.datepicker())})}(jQuery);